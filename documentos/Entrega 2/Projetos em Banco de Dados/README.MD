# üß© Banco de Dados - Projeto √Åuria

Este projeto implementa um banco de dados MySQL chamado **`auria`**, desenvolvido para gerenciar grupos, usu√°rios, doa√ß√µes e comunica√ß√µes por e-mail dentro da plataforma √Åuria ‚Äî um sistema colaborativo voltado √† arrecada√ß√£o de recursos e alimentos.

---

## üèóÔ∏è Estrutura Geral

O banco de dados cont√©m as seguintes tabelas principais:

1. **`users`** ‚Äì Armazena as informa√ß√µes dos usu√°rios cadastrados.  
2. **`groups`** ‚Äì Representa os grupos de arrecada√ß√£o e suas metas.  
3. **`donations`** ‚Äì Registra as doa√ß√µes realizadas pelos usu√°rios.  
4. **`email_outbox`** ‚Äì Gerencia o envio de e-mails autom√°ticos.  
5. **`invitations`** ‚Äì Controla convites enviados para novos usu√°rios.

Essas tabelas foram criadas utilizando o mecanismo **InnoDB** e o conjunto de caracteres **utf8mb4**, garantindo suporte a acentua√ß√£o e emojis.

---

## üß± Estrutura das Tabelas

### 1. Tabela `users`

Armazena os dados dos usu√°rios cadastrados na plataforma.

| Campo | Tipo | Descri√ß√£o |
|-------|------|------------|
| `id` | INT (PK) | Identificador √∫nico do usu√°rio |
| `group_id` | INT (FK) | Grupo ao qual o usu√°rio pertence |
| `name` | VARCHAR(255) | Nome completo do usu√°rio |
| `email` | VARCHAR(255) | Endere√ßo de e-mail (√∫nico) |
| `type` | ENUM('Mentor','Colaborador','Administrador') | Fun√ß√£o do usu√°rio |
| `password` | VARCHAR(255) | Senha criptografada |
| `created_at` | TIMESTAMP | Data de cria√ß√£o do usu√°rio |
| `current_money_collection` | DOUBLE | Total em dinheiro doado |
| `current_food_collection` | DOUBLE | Total em alimentos doados |
| `status` | TINYINT(1) | Indica se o usu√°rio est√° ativo (1) ou inativo (0) |

üîó **Relacionamentos:**
- `group_id` ‚Üí chave estrangeira que referencia `groups.id`.

---

### 2. Tabela `groups`

Representa os grupos de arrecada√ß√£o e seus objetivos.

| Campo | Tipo | Descri√ß√£o |
|--------|------|------------|
| `id` | INT (PK) | Identificador √∫nico do grupo |
| `name` | VARCHAR(45) | Nome do grupo |
| `members` | INT | Quantidade de integrantes |
| `created_at` | TIMESTAMP | Data de cria√ß√£o do grupo |
| `monetary_target` | DOUBLE | Meta financeira (em R$) |
| `food_goal` | DOUBLE | Meta de alimentos (em Kg) |
| `current_food_collection` | DOUBLE | Total atual arrecadado em alimentos |
| `current_money_collection` | DOUBLE | Total atual arrecadado em dinheiro |
| `status` | TINYINT(1) | Indica se o grupo est√° ativo (1) ou inativo (0) |

---

### 3. Tabela `donations`

Registra as doa√ß√µes realizadas pelos usu√°rios.

| Campo | Tipo | Descri√ß√£o |
|--------|------|-----------|
| `id` | INT (PK) | Identificador √∫nico da doa√ß√£o |
| `id_group` | INT (FK) | Grupo beneficiado pela doa√ß√£o |
| `type` | TINYINT(1) | Tipo de doa√ß√£o (0 = alimento, 1 = dinheiro) |
| `quantity` | DOUBLE | Quantidade doada (Kg ou R$) |
| `user_agent` | VARCHAR(255) | Identifica√ß√£o do usu√°rio doador |
| `proof` | VARCHAR(255) | Caminho do arquivo de comprovante |
| `inserted_at` | TIMESTAMP | Data/hora da doa√ß√£o |
| `score_fraud` | INT | √çndice de risco de fraude |

üîó **Relacionamentos:**
- `id_group` ‚Üí chave estrangeira que referencia `groups.id`.

---

### 4. Tabela `email_outbox`

Gerencia o envio de e-mails autom√°ticos da aplica√ß√£o (como convites e notifica√ß√µes).

| Campo | Tipo | Descri√ß√£o |
|--------|------|-----------|
| `id` | BIGINT (PK) | Identificador do e-mail |
| `from_email` | VARCHAR(255) | Endere√ßo do remetente |
| `to_email` | VARCHAR(255) | Endere√ßo do destinat√°rio |
| `subject` | VARCHAR(255) | Assunto do e-mail |
| `body_text` | MEDIUMTEXT | Corpo do e-mail em texto puro |
| `body_html` | MEDIUMTEXT | Corpo do e-mail em HTML |
| `sent_at` | DATETIME | Data/hora do envio |
| `last_error` | TEXT | Mensagem de erro (se houver falha) |
| `retries` | INT | N√∫mero de tentativas de envio |
| `created_at` | TIMESTAMP | Data de cria√ß√£o do registro |

---

### 5. Tabela `invitations`

Controla os convites enviados a novos usu√°rios para participarem de grupos.

| Campo | Tipo | Descri√ß√£o |
|--------|------|-----------|
| `id` | BIGINT (PK) | Identificador do convite |
| `group_id` | INT (FK) | Grupo relacionado ao convite |
| `email` | VARCHAR(255) | E-mail do convidado |
| `role` | VARCHAR(50) | Fun√ß√£o oferecida no grupo |
| `token_hash` | VARBINARY(32) | Token criptografado para aceite |
| `status` | ENUM('pending','accepted','revoked','expired') | Situa√ß√£o atual do convite |
| `invited_by_user_id` | INT | ID do usu√°rio que fez o convite |
| `expires_at` | DATETIME | Data de expira√ß√£o do convite |
| `accepted_at` | DATETIME | Data de aceite |
| `revoked_at` | DATETIME | Data de revoga√ß√£o |
| `created_at` | TIMESTAMP | Data de cria√ß√£o |
| `updated_at` | TIMESTAMP | √öltima atualiza√ß√£o |

üîó **Relacionamentos:**
- `group_id` ‚Üí chave estrangeira que referencia `groups.id`.

---

## üîë Relacionamentos Principais

```mermaid
erDiagram
    GROUPS ||--o{ USERS : possui
    GROUPS ||--o{ DONATIONS : recebe
    GROUPS ||--o{ INVITATIONS : gera
    USERS ||--o{ DONATIONS : realiza
